---
title: "django-taggit"
date: 2023-07-01
subtitle: "django-taggit"
category: "Django"
draft: false
---

# Tag

https://django-taggit.readthedocs.io/en/latest/index.html

1. Install

pip install django-taggit

2. settings.py

```python
INSTALLED_APPS = [
    ...
    'taggit',
]

TAGGIT_CASE_INSENSITIVE = True
TAGGIT_LIMIT = 50
```

3. 사용하고 싶은 모델에 아래 필드 추가

```python
from taggit.managers import TaggableManager

class Campaign(models.Model):
    ...
    tags = TaggableManager(blank=True)
```

4. Usage with DRF

```python
from taggit.serializers import (TagListSerializerField,
                                TaggitSerializer)


class CampaignCreateSerializer(TaggitSerializer, serializers.ModelSerializer):
        class Meta:
        model = Campaign
        fields = (
            ...
            "tags",
        )

    tags = TagListSerializerField()
```

5. admin.py

ModelAdmin.`list_display`에 TaggableManager를 포함시킬 경우 다음과 같은 에러가 나온다.

```bash
AttributeError: '_TaggableManager' object has no attribute 'name'
```

`list_display`에 ManyToManyField를 포함시킬 수 없는 이유와 같다고 한다.

ModelAdmin.list_display에 태그를 표시하려면 쿼리를 최소화하기 위해 `prefetch_related()`를 사용하여 추가할 수 있다.

```python
class MyModelAdmin(admin.ModelAdmin):
    list_display = ['tag_list']

    def get_queryset(self, request):
        return super().get_queryset(request).prefetch_related('tags')

    def tag_list(self, obj):
        return u", ".join(o.name for o in obj.tags.all())
```

## Error

form-data로 요청을 보내니 tags에 아무리 요청을 보내도

![Alt text](taggit1.png)

와 같이 쉼표로 분리되질 않았다.

form-data에서 여러 값을 하나의 키로 보내기 위해서는 각 값을 따로따로 입력해줘야 했다. 태그들을 각각의 키로 입력시켜주니

![Alt text](taggit2.png)

쉼표로 분리시키는 것에 성공했다. 프론트 적용시킬 때 조심해야할 것 같다.
